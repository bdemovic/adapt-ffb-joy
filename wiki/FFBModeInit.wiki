#summary Initialization procedure of FFB mode for FFP's
#labels Featured

= Introduction =

A tester connected to real game port's X1-line (AVR pin B4) prints the following interrupt sequences at enumeration and startup of an FFB application:

(The log below has microsecond offset timestamps at the end after the "+"-sign - timestamps have accuracy of at most 4us and may have slight distortion - but this should give the overview of what happens and that something really happens there)

{{{
1000000000: INTERRUPT from X1 (0)
1000000012: INTERRUPT from X1 (1) +12 _(this interrupt came 12us after the previous one etc)_
1000000020: INTERRUPT from X1 (2) +20
1000000016: INTERRUPT from X1 (3) +16
1000000016: INTERRUPT from X1 (4) +16
1000006844: INTERRUPT from X1 (0) +6844
1000000012: INTERRUPT from X1 (1) +12
1000000032: INTERRUPT from X1 (0) +32
1000000012: INTERRUPT from X1 (1) +12
1000000036: INTERRUPT from X1 (2) +36
1000000344: INTERRUPT from X1 (3) +344
1000000016: INTERRUPT from X1 (4) +16
1000000044: INTERRUPT from X1 (5) +44
1000000052: INTERRUPT from X1 (6) +52
1000000308: INTERRUPT from X1 (7) +308
1000000020: INTERRUPT from X1 (8) +20
1000000408: INTERRUPT from X1 (9) +408
1000024512: INTERRUPT from X1 (0) +24512
1000000008: INTERRUPT from X1 (1) +8
1000000024: INTERRUPT from X1 (0) +24
1000000020: INTERRUPT from X1 (1) +20
1000000020: INTERRUPT from X1 (2) +20
1000000352: INTERRUPT from X1 (3) +352
1000000016: INTERRUPT from X1 (4) +16
1000000016: INTERRUPT from X1 (5) +16
1000000020: INTERRUPT from X1 (6) +20
1000000032: INTERRUPT from X1 (7) +32
1000000364: INTERRUPT from X1 (8) +364
1000000024: INTERRUPT from X1 (9) +24
1000003008: INTERRUPT from X1 (0) +3008
1000000012: INTERRUPT from X1 (1) +12
1000000024: INTERRUPT from X1 (2) +24
1000000020: INTERRUPT from X1 (3) +20
1000000024: INTERRUPT from X1 (4) +24
1000000020: INTERRUPT from X1 (5) +20
1000000332: INTERRUPT from X1 (6) +332
1000000020: INTERRUPT from X1 (7) +20
1000000024: INTERRUPT from X1 (8) +24
}}}
And only then PC sends the MIDI data:

{{{
c5 01
...
}}}

Some interrupts are still sent in X1-line after the first MIDI command. Details on those later.

To verify the tester's output, the below is produced when looking at the Y2-line (AVR pin B5) from 3DPVert's startup sequence with FFP:

{{{
1000000000: INTERRUPT from Y2 (0) 0
1000000192: INTERRUPT from Y2 (0) +192
1000000916: INTERRUPT from Y2 (1) +916
1000000488: INTERRUPT from Y2 (0) +488
1000004088: INTERRUPT from Y2 (0) +4088
1000216380: INTERRUPT from Y2 (0) +216380
1000012340: INTERRUPT from Y2 (0) +12340
1000000160: INTERRUPT from Y2 (0) +160
1000008152: INTERRUPT from Y2 (0) +8152
1001144192: INTERRUPT from Y2 (0) +1144192
1000004672: INTERRUPT from Y2 (0) +4672
1000004676: INTERRUPT from Y2 (0) +4676
1000004676: INTERRUPT from Y2 (0) +4676
...(repeat forever every 4.676 ms)...
}}}